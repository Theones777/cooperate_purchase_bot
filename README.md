# Бот для проведения совместной закупки

## Для запуска бота необходимо:
1. Создать .env файл в корне проекта. Указать переменные:
- BOT_TOKEN = токен бота от BotFather
- ADMIN_IDS = id пользователей ТГ, у которых должны быть права админа
- GS_CONFIG = имя json-файла с кредами для подключения к Google API
- GS_SHEET_NAME = название Google-таблицы со сводными данными
- API_ID - получить здесь: https://my.telegram.org/
- API_HASH - получить здесь: https://my.telegram.org/
- SESSION_STRING - запустить get_session_string.py
- PAYMENT_BOT_USERNAME - имя бота для получения ссылки на оплату

При необходимости:
- DB_URL = адрес базы данных
- CUSTOM_PRICE_WORKSHEET_PREFIX = префикс для гугл-страниц с прайсом товаров
- MAKE_CUSTOM_PREFIX = префикс для сообщения, чтобы сделать заказ
- PRODUCT_NAME_COLUMN_NAME = имя колонки с название товара
- PRODUCT_PRICE_COLUMN_NAME = имя колонки с ценой товара
- AVAILABLE_COLUMN_NAME = имя колонки с участием товара в данной закупке

2. Получить json-файл с кредами для подключения к Google API. И положить его в корень проекта
3. Либо запустить main.py для локального запуска либо вызвать `docker-compose up -d --build` в корне проекта


## NB! Нельзя подключаться к БД во время работы бота через docker. 
Для внесения изменений в БД:
1. Остановить работу бота;
2. Скопировать все 3 файла БД в другое место;
3. Подключиться к новой БД;
4. Внести изменения и сохранить их;
5. Перенести 3 новых файла в том БД бота;
6. Запустить контейнер с ботом



##### TODO
1. Проверка оплаты по АПИ
2. Обработка большого кол-ва запросов об оплате
3. Для каждого пункта в прайсе и заказе - отдельные строки